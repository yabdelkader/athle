<!DOCTYPE html>
<html lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">


<link href="../css/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css" />
<link href="../css/dataTables.bootstrap.min.css" media="screen" rel="stylesheet" type="text/css" />
<link href="../css/athle.css" media="screen" rel="stylesheet" type="text/css" />


<script src="../js/jquery-1.12.3.js" type="text/javascript"></script>
<script src="../js/jquery.dataTables.min.js" type="text/javascript"></script>
<script src="../js/dataTables.bootstrap.min.js"></script>
<script src="../js/bootstrap.min.js" type="text/javascript"></script>

<style type="text/css">
body {
	font-size:1.1rem;
}
input{
}

pre {
	width : 700px;
}
fieldset.scheduler-border {
    border: 1px groove #ddd !important;
    padding: 0 1.4em 1.4em 1.4em !important;
    margin: 0 0 1.5em 0 !important;
    -webkit-box-shadow:  0px 0px 0px 0px #000;
            box-shadow:  0px 0px 0px 0px #000;
}
legend.scheduler-border {
    width:inherit; /* Or auto */
    padding:0 10px; /* To give a bit of padding on the left and right */
    border-bottom:none;
}
</style>

<title>Cross départementaux 94, régionnaux Est, LIFA</title>
</head>

<body>
	<article class="content">
		<div class="row">
			<div class="col-md-12">
			SELECT  annee, championnat, sexe, count(*) FROM cros group by annee, championnat, sexe
			</div>
			<div class="col-md-4">
				<form class="form-horizontal"  action="resultats_cross.php" method="post">
					<div class="form-group">
						<label class="control-label col-sm-3" >Sexe</label> 
						<div class="col-sm-8">
							<label class="radio-inline"><input type="radio" name="sexe1" value="F" required="required">Féminin</label>
							<label class="radio-inline"><input type="radio" name="sexe1" value="M" checked="checked">Masculin</label>
						</div>
						
						<label class="control-label col-sm-3" >Catégorie</label>
						<div class="col-sm-8">
							<label class="radio-inline"><input type="radio" name="categorie1" value="S">Senior</label>
							<label class="radio-inline"><input type="radio" name="categorie1" value="M" checked="checked">Master</label>
						</div>
						
						<label class="control-label col-sm-3" >Championnat</label>
						<div class="col-sm-8">
							<label class="radio-inline"><input type="radio" name="championnat1" value="dep" checked="checked"> Dép</label>
							<label class="radio-inline"><input type="radio" name="championnat1" value="reg">Rég</label>
							<label class="radio-inline"><input type="radio" name="championnat1" value="lifa">Lifa</label>
						</div>

						<label class="control-label col-sm-3" style="margin-top: 10px">Année</label>
						<div class="col-sm-3"  style="margin-top: 10px">
							<input class="form-control" type="number" name="annee1" value="2020">
						</div>	
					</div>
				</form>
				<table class="table table-striped table-bordered" id="table_resultats1"></table>
			</div>
	
			<div class="col-md-4">
				<form class="form-horizontal"  action="resultats_cross.php" method="post">
					<div class="form-group">
						<label class="control-label col-sm-2" >Sexe</label> 
						<div class="col-sm-10">
							<label class="radio-inline"><input type="radio" name="sexe2" value="F" required="required">Féminin</label>
							<label class="radio-inline"><input type="radio" name="sexe2" value="M" checked="checked">Masculin</label>
						</div>
						<label class="control-label col-sm-2" >Catégorie</label>
						<div class="col-sm-10">
							<label class="radio-inline"><input type="radio" name="categorie2" value="S">Senior</label>
							<label class="radio-inline"><input type="radio" name="categorie2" value="M" checked="checked">Master</label>
						</div>
						<label class="control-label col-sm-3" >Championnat</label>
						<div class="col-sm-8">
							<label class="radio-inline"><input type="radio" name="championnat2" value="dep"> Dép</label>
							<label class="radio-inline"><input type="radio" name="championnat2" value="reg" checked="checked">Rég</label>
							<label class="radio-inline"><input type="radio" name="championnat2" value="lifa">Lifa</label>
						</div>
						<label class="control-label col-sm-2" >Année</label>
						<div class="col-sm-3">
							<input class="form-control" type="number" name="annee2" value="2020">
						</div>	
					</div>
				</form>
				<table class="table table-striped table-bordered" id="table_resultats2"></table>
			</div>
		</div>
	</article>
	
	<script type="text/javascript">

    function selection(i) {
        
    	var sexe		= $("input[name='sexe" + i + "']:checked").val();
    	var categorie	= $("input[name='categorie" + i + "']:checked").val();
		var championnat	= $("input[name='championnat" + i + "']:checked").val();
		var annee		= $("input[name='annee" + i + "']").val();
    	
    	if (sexe == undefined || categorie == undefined || annee == undefined){
			return;    		
    	}

    	var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {

            	var reponseGetResultats = this.responseText;
                
	            var jsonData = JSON.parse(reponseGetResultats);
	            // for (var i = 0; i < jsonData.resultats.length; i++) {
	            // 	pays = jsonData.resultats[i];
	            //}
	            charge(jsonData.cross, i);

            }
        };
        xmlhttp.open("GET", "getCross.php?championnat=" + championnat + "&categorie=" + categorie + "&seye=" + sexe + "&annee=" + annee, true);
        xmlhttp.send();
    	
    }
    
    function charge(cross, i){
        
    	var laTable = $("#table_resultats" + i).DataTable();
    	laTable.clear();
    	
    	for (var i = 0; i < cross.length; i++) {
    		laTable.row.add({r: cross[i].r, c: cross[i].c, n: cross[i].n}).draw();
    	}
    }

    $('.dropdown-toggle').dropdown();
	
	var resultats1 = { data : [ ]};
	var resultats2 = { data : [ ]};
	var resultats3 = { data : [ ]};
		
	var table1 = $('#table_resultats1').DataTable({
			data : resultats1.data,
	        "paging": false, 
	        "info": false,         
		  columns : [
		    { data: 'r', title: 'Rang' },
		    { data: 'c', title: 'Chrono' },
		    { data: 'n', title: 'Nom' }
  
	      ]  
		});

	var table2 = $('#table_resultats2').DataTable({
		data : resultats2.data,
        "paging": false, 
        "info": false,         
	  columns : [
	    { data: 'r', title: 'Rang' },
	    { data: 'c', title: 'Chrono' },
	    { data: 'n', title: 'Nom' }

      ]  
	});

	var elts = document.querySelectorAll("input");
	for (var i = 0; i < elts.length; i++){
		elts[i].addEventListener("change", selection, true);
	}	
	
	selection(1);
	selection(2);
	</script>
</body>
</html>